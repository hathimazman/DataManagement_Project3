{"paragraphs":[{"text":"%md\n### Let's make sure Spark is working first!","user":"anonymous","dateUpdated":"2025-05-29T02:32:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's make sure Spark is working first!</h3>\n"}]},"apps":[],"jobName":"paragraph_1748484118342_-1589328386","id":"20250529-020158_315645041","dateCreated":"2025-05-29T02:01:58+0000","dateStarted":"2025-05-29T02:32:23+0000","dateFinished":"2025-05-29T02:32:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8362"},{"text":"%sh\npwd\n","user":"anonymous","dateUpdated":"2025-05-29T02:50:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/home/zeppelin\n"}]},"apps":[],"jobName":"paragraph_1748486996460_-177366153","id":"20250529-024956_1708996666","dateCreated":"2025-05-29T02:49:56+0000","dateStarted":"2025-05-29T02:50:42+0000","dateFinished":"2025-05-29T02:50:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8363"},{"text":"%spark2\nsc.version\n","user":"anonymous","dateUpdated":"2025-05-29T02:38:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1748484200053_36174420","id":"20250529-020320_1611867712","dateCreated":"2025-05-29T02:03:20+0000","dateStarted":"2025-05-29T02:38:20+0000","dateFinished":"2025-05-29T02:38:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8364"},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downloaded!\"","user":"anonymous","dateUpdated":"2025-05-29T02:38:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-05-29 02:38:36--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 54.231.196.129, 16.15.178.30, 3.5.24.44, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|54.231.196.129|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  103K 19s\n    50K .......... .......... .......... .......... ..........  4% 1.07M 10s\n   100K .......... .......... .......... .......... ..........  7%  247K 9s\n   150K .......... .......... .......... .......... ..........  9% 12.6M 7s\n   200K .......... .......... .......... .......... .......... 12%  210K 7s\n   250K .......... .......... .......... .......... .......... 14% 11.2M 6s\n   300K .......... .......... .......... .......... .......... 17% 11.3M 5s\n   350K .......... .......... .......... .......... .......... 19%  195K 5s\n   400K .......... .......... .......... .......... .......... 22% 2.23M 4s\n   450K .......... .......... .......... .......... .......... 24% 22.8M 4s\n   500K .......... .......... .......... .......... .......... 27% 96.8M 3s\n   550K .......... .......... .......... .......... .......... 29% 60.5M 3s\n   600K .......... .......... .......... .......... .......... 32%  235K 3s\n   650K .......... .......... .......... .......... .......... 34% 20.7M 3s\n   700K .......... .......... .......... .......... .......... 36% 21.4M 3s\n   750K .......... .......... .......... .......... .......... 39% 53.6M 2s\n   800K .......... .......... .......... .......... .......... 41%  124M 2s\n   850K .......... .......... .......... .......... .......... 44% 63.9M 2s\n   900K .......... .......... .......... .......... .......... 46% 2.23M 2s\n   950K .......... .......... .......... .......... .......... 49% 11.7M 2s\n  1000K .......... .......... .......... .......... .......... 51%  248K 2s\n  1050K .......... .......... .......... .......... .......... 54% 5.95M 1s\n  1100K .......... .......... .......... .......... .......... 56% 11.1M 1s\n  1150K .......... .......... .......... .......... .......... 59% 2.15M 1s\n  1200K .......... .......... .......... .......... .......... 61% 10.3M 1s\n  1250K .......... .......... .......... .......... .......... 64%  252K 1s\n  1300K .......... .......... .......... .......... .......... 66% 5.52M 1s\n  1350K .......... .......... .......... .......... .......... 68% 7.49M 1s\n  1400K .......... .......... .......... .......... .......... 71% 12.0M 1s\n  1450K .......... .......... .......... .......... .......... 73% 2.25M 1s\n  1500K .......... .......... .......... .......... .......... 76% 8.91M 1s\n  1550K .......... .......... .......... .......... .......... 78%  254K 1s\n  1600K .......... .......... .......... .......... .......... 81% 6.29M 1s\n  1650K .......... .......... .......... .......... .......... 83% 6.14M 0s\n  1700K .......... .......... .......... .......... .......... 86% 11.2M 0s\n  1750K .......... .......... .......... .......... .......... 88% 11.4M 0s\n  1800K .......... .......... .......... .......... .......... 91% 2.20M 0s\n  1850K .......... .......... .......... .......... .......... 93% 11.1M 0s\n  1900K .......... .......... .......... .......... .......... 96%  250K 0s\n  1950K .......... .......... .......... .......... .......... 98% 7.09M 0s\n  2000K .......... .......... ..........                      100% 9.26M=2.5s\n\n2025-05-29 02:38:39 (826 KB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2025-05-29 02:38:39--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 16.182.105.65, 52.216.152.252, 54.231.201.41, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|16.182.105.65|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  101K 2s\n    50K .......... .......... .......... .......... .......... 43%  982K 1s\n   100K .......... .......... .......... .......... .......... 64%  250K 0s\n   150K .......... .......... .......... .......... .......... 86% 11.3M 0s\n   200K .......... .......... ..........                      100%  128K=1.0s\n\n2025-05-29 02:38:41 (233 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownloaded!\n"}]},"apps":[],"jobName":"paragraph_1748484209953_-2012228724","id":"20250529-020329_572300856","dateCreated":"2025-05-29T02:03:29+0000","dateStarted":"2025-05-29T02:38:36+0000","dateFinished":"2025-05-29T02:38:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8365"},{"text":"%sh\n\nhadoop fs -rm -r -f /tmp/ml-100k\n\nhadoop fs -mkdir /tmp/ml-100k/\n\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-05-29T02:38:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"25/05/29 02:38:46 INFO fs.TrashPolicyDefault: Moved: 'hdfs://sandbox-hdp.hortonworks.com:8020/tmp/ml-100k' to trash at: hdfs://sandbox-hdp.hortonworks.com:8020/user/zeppelin/.Trash/Current/tmp/ml-100k1748486326468\n"}]},"apps":[],"jobName":"paragraph_1748484303505_-369999470","id":"20250529-020503_1574066502","dateCreated":"2025-05-29T02:05:03+0000","dateStarted":"2025-05-29T02:38:45+0000","dateFinished":"2025-05-29T02:38:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8366"},{"text":"final case class Rating(movieID: Int, rating : Int)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x => {val fields = x.split(\"\\t\"); Rating(fields(1).toInt, fields(2).toInt)})","user":"anonymous","dateUpdated":"2025-05-29T02:38:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[2] at map at <console>:28\n"}]},"apps":[],"jobName":"paragraph_1748484460260_1511284734","id":"20250529-020740_1061917772","dateCreated":"2025-05-29T02:07:40+0000","dateStarted":"2025-05-29T02:38:55+0000","dateFinished":"2025-05-29T02:38:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8367"},{"text":"import sqlContext.implicits._\n\nval ratingsDF = lines.toDF()\n\nratingsDF.printSchema()","user":"anonymous","dateUpdated":"2025-05-29T02:38:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: int]\nroot\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1748484934280_54110954","id":"20250529-021534_283859694","dateCreated":"2025-05-29T02:15:34+0000","dateStarted":"2025-05-29T02:38:59+0000","dateFinished":"2025-05-29T02:39:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8368"},{"text":"val topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\n\ntopMovieIDs.show()","user":"anonymous","dateUpdated":"2025-05-29T02:39:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  584|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  368|\n|    222|  365|\n|    204|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748484814772_-1500090712","id":"20250529-021334_135420251","dateCreated":"2025-05-29T02:13:34+0000","dateStarted":"2025-05-29T02:39:03+0000","dateFinished":"2025-05-29T02:39:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8369"},{"text":"ratingsDF.registerTempTable(\"ratings\")","user":"anonymous","dateUpdated":"2025-05-29T02:39:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1748485142514_142293429","id":"20250529-021902_1387584766","dateCreated":"2025-05-29T02:19:02+0000","dateStarted":"2025-05-29T02:39:15+0000","dateFinished":"2025-05-29T02:39:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8370"},{"text":"%sql\n\nSELECT * FROM ratings LIMIT 10","user":"anonymous","dateUpdated":"2025-05-29T02:39:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\trating\n50\t5\n172\t5\n133\t1\n242\t3\n302\t3\n377\t1\n51\t2\n346\t1\n474\t4\n265\t2\n"}]},"apps":[],"jobName":"paragraph_1748485190628_1981670651","id":"20250529-021950_1958503129","dateCreated":"2025-05-29T02:19:50+0000","dateStarted":"2025-05-29T02:39:24+0000","dateFinished":"2025-05-29T02:39:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8371"},{"text":"%sql\nSELECT rating, COUNT(*) as count FROM ratings GROUP BY rating","user":"anonymous","dateUpdated":"2025-05-29T02:41:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tcount\n1\t6111\n3\t27145\n5\t21203\n4\t34174\n2\t11370\n"}]},"apps":[],"jobName":"paragraph_1748485211980_-2003711698","id":"20250529-022011_565203967","dateCreated":"2025-05-29T02:20:11+0000","dateStarted":"2025-05-29T02:41:11+0000","dateFinished":"2025-05-29T02:41:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8372"},{"text":"final case class Movie(movieID: Int, title: String)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {val fields = x.split('|'); Movie(fields(0).toInt, fields(1))})\n\nimport sqlContext.implicits._\nval moviesDF = lines.toDF()\n\nmoviesDF.show()","user":"anonymous","dateUpdated":"2025-05-29T02:52:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[50] at map at <console>:39\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+--------------------+\n|movieID|               title|\n+-------+--------------------+\n|      1|    Toy Story (1995)|\n|      2|    GoldenEye (1995)|\n|      3|   Four Rooms (1995)|\n|      4|   Get Shorty (1995)|\n|      5|      Copycat (1995)|\n|      6|Shanghai Triad (Y...|\n|      7|Twelve Monkeys (1...|\n|      8|         Babe (1995)|\n|      9|Dead Man Walking ...|\n|     10|  Richard III (1995)|\n|     11|Seven (Se7en) (1995)|\n|     12|Usual Suspects, T...|\n|     13|Mighty Aphrodite ...|\n|     14|  Postino, Il (1994)|\n|     15|Mr. Holland's Opu...|\n|     16|French Twist (Gaz...|\n|     17|From Dusk Till Da...|\n|     18|White Balloon, Th...|\n|     19|Antonia's Line (1...|\n|     20|Angels and Insect...|\n+-------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748486471254_759719059","id":"20250529-024111_804729326","dateCreated":"2025-05-29T02:41:11+0000","dateStarted":"2025-05-29T02:52:53+0000","dateFinished":"2025-05-29T02:52:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8373"},{"text":"moviesDF.registerTempTable(\"titles\")","user":"anonymous","dateUpdated":"2025-05-29T02:53:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1748486728288_1779671424","id":"20250529-024528_1808954610","dateCreated":"2025-05-29T02:45:28+0000","dateStarted":"2025-05-29T02:53:18+0000","dateFinished":"2025-05-29T02:53:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8374"},{"text":"%sql\n\nSELECT t.title, count(*) cnt \nFROM ratings r \nJOIN titles t \nON r.movieID = t.movieID \nGROUP BY t.title \nORDER BY cnt DESC LIMIT 20","user":"anonymous","dateUpdated":"2025-05-29T02:58:26+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tcnt\nStar Wars (1977)\t584\nContact (1997)\t509\nFargo (1996)\t508\nReturn of the Jedi (1983)\t507\nLiar Liar (1997)\t485\nEnglish Patient, The (1996)\t481\nScream (1996)\t478\nToy Story (1995)\t452\nAir Force One (1997)\t431\nIndependence Day (ID4) (1996)\t429\nRaiders of the Lost Ark (1981)\t420\nGodfather, The (1972)\t413\nPulp Fiction (1994)\t394\nTwelve Monkeys (1995)\t392\nSilence of the Lambs, The (1991)\t390\nJerry Maguire (1996)\t384\nChasing Amy (1997)\t379\nRock, The (1996)\t378\nEmpire Strikes Back, The (1980)\t368\nStar Trek: First Contact (1996)\t365\n"}]},"apps":[],"jobName":"paragraph_1748487197969_-517809278","id":"20250529-025317_1677772560","dateCreated":"2025-05-29T02:53:17+0000","dateStarted":"2025-05-29T02:58:27+0000","dateFinished":"2025-05-29T02:58:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8375"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2025-05-29T02:54:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1748487248242_2082216520","id":"20250529-025408_593208277","dateCreated":"2025-05-29T02:54:08+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8376"}],"name":"STQD6324_Data_Management_Class","id":"2KURPSKBT","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}