{"paragraphs":[{"text":"%md\n# This Project aims to explore the `u.user` file from the Movielnes 100k Dataset.","user":"anonymous","dateUpdated":"2025-06-01T08:13:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>This Project aims to explore the <code>u.user</code> file from the Movielnes 100k Dataset.</h1>\n"}]},"apps":[],"jobName":"paragraph_1748763943173_-1843434476","id":"20250601-074543_2144772667","dateCreated":"2025-06-01T07:45:43+0000","dateStarted":"2025-06-01T08:13:23+0000","dateFinished":"2025-06-01T08:13:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:208440"},{"text":"%md\n## Download the file to a local temp folder","user":"anonymous","dateUpdated":"2025-06-01T09:59:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Download the file to a local temp folder</h2>\n"}]},"apps":[],"jobName":"paragraph_1748771973836_579024959","id":"20250601-095933_900818063","dateCreated":"2025-06-01T09:59:33+0000","dateStarted":"2025-06-01T09:59:46+0000","dateFinished":"2025-06-01T09:59:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208441"},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downloaded ml-100k dataset!\"","user":"anonymous","dateUpdated":"2025-06-01T09:59:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-06-01 08:12:17--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.214.9, 3.5.17.124, 52.217.224.129, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.214.9|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 82.6K=0.3s\n\n2025-06-01 08:12:18 (82.6 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\n--2025-06-01 08:12:18--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.214.9, 3.5.17.124, 52.217.224.129, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.214.9|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2% 97.3K 20s\n    50K .......... .......... .......... .......... ..........  4%  261K 14s\n   100K .......... .......... .......... .......... ..........  7%  580K 10s\n   150K .......... .......... .......... .......... ..........  9% 25.3M 7s\n   200K .......... .......... .......... .......... .......... 12%  209K 7s\n   250K .......... .......... .......... .......... .......... 14% 8.54M 6s\n   300K .......... .......... .......... .......... .......... 17% 6.50M 5s\n   350K .......... .......... .......... .......... .......... 19% 6.60M 4s\n   400K .......... .......... .......... .......... .......... 22%  205K 5s\n   450K .......... .......... .......... .......... .......... 24%  353M 4s\n   500K .......... .......... .......... .......... .......... 27% 15.0M 4s\n   550K .......... .......... .......... .......... .......... 29%  487M 3s\n   600K .......... .......... .......... .......... .......... 32% 4.49M 3s\n   650K .......... .......... .......... .......... .......... 34%  257M 2s\n   700K .......... .......... .......... .......... .......... 36% 7.64M 2s\n   750K .......... .......... .......... .......... .......... 39% 37.9M 2s\n   800K .......... .......... .......... .......... .......... 41%  473M 2s\n   850K .......... .......... .......... .......... .......... 44%  308K 2s\n   900K .......... .......... .......... .......... .......... 46%  629K 2s\n   950K .......... .......... .......... .......... .......... 49%  313M 2s\n  1000K .......... .......... .......... .......... .......... 51% 2.07M 1s\n  1050K .......... .......... .......... .......... .......... 54%  493M 1s\n  1100K .......... .......... .......... .......... .......... 56% 3.10M 1s\n  1150K .......... .......... .......... .......... .......... 59%  391M 1s\n  1200K .......... .......... .......... .......... .......... 61% 4.83M 1s\n  1250K .......... .......... .......... .......... .......... 64% 9.73M 1s\n  1300K .......... .......... .......... .......... .......... 66%  324M 1s\n  1350K .......... .......... .......... .......... .......... 68% 12.3M 1s\n  1400K .......... .......... .......... .......... .......... 71%  452M 1s\n  1450K .......... .......... .......... .......... .......... 73% 22.8M 1s\n  1500K .......... .......... .......... .......... .......... 76%  153M 1s\n  1550K .......... .......... .......... .......... .......... 78% 22.6M 0s\n  1600K .......... .......... .......... .......... .......... 81%  409M 0s\n  1650K .......... .......... .......... .......... .......... 83%  530M 0s\n  1700K .......... .......... .......... .......... .......... 86%  378M 0s\n  1750K .......... .......... .......... .......... .......... 88%  432K 0s\n  1800K .......... .......... .......... .......... .......... 91%  669K 0s\n  1850K .......... .......... .......... .......... .......... 93% 6.02M 0s\n  1900K .......... .......... .......... .......... .......... 96%  458M 0s\n  1950K .......... .......... .......... .......... .......... 98% 49.3M 0s\n  2000K .......... .......... ..........                      100%  446M=1.8s\n\n2025-06-01 08:12:20 (1.09 MB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2025-06-01 08:12:21--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 3.5.19.210, 3.5.25.109, 52.217.131.89, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|3.5.19.210|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21% 99.8K 2s\n    50K .......... .......... .......... .......... .......... 43%  201K 1s\n   100K .......... .......... .......... .......... .......... 64% 5.06M 0s\n   150K .......... .......... .......... .......... .......... 86% 2.32M 0s\n   200K .......... .......... ..........                      100%  134K=1.0s\n\n2025-06-01 08:12:23 (228 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownloaded ml-100k dataset!\n"}]},"apps":[],"jobName":"paragraph_1748764051769_-197509330","id":"20250601-074731_1685467887","dateCreated":"2025-06-01T07:47:31+0000","dateStarted":"2025-06-01T08:12:17+0000","dateFinished":"2025-06-01T08:12:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208442"},{"text":"%md\n## Remove the directory if already available\n","user":"anonymous","dateUpdated":"2025-06-01T10:00:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Remove the directory if already available</h2>\n"}]},"apps":[],"jobName":"paragraph_1748771994421_216606819","id":"20250601-095954_799972724","dateCreated":"2025-06-01T09:59:54+0000","dateStarted":"2025-06-01T10:00:02+0000","dateFinished":"2025-06-01T10:00:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208443"},{"text":"%sh\nhadoop fs -rm -r -f /tmp/ml-100k","user":"anonymous","dateUpdated":"2025-06-01T09:59:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"25/06/01 08:14:23 INFO fs.TrashPolicyDefault: Moved: 'hdfs://sandbox-hdp.hortonworks.com:8020/tmp/ml-100k' to trash at: hdfs://sandbox-hdp.hortonworks.com:8020/user/zeppelin/.Trash/Current/tmp/ml-100k1748765663808\n"}]},"apps":[],"jobName":"paragraph_1748765653566_116717198","id":"20250601-081413_440084588","dateCreated":"2025-06-01T08:14:13+0000","dateStarted":"2025-06-01T08:14:20+0000","dateFinished":"2025-06-01T08:14:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208444"},{"text":"%md\n## Create a new directory","user":"anonymous","dateUpdated":"2025-06-01T10:00:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Create a new directory</h2>\n"}]},"apps":[],"jobName":"paragraph_1748772007443_-660773915","id":"20250601-100007_453821859","dateCreated":"2025-06-01T10:00:07+0000","dateStarted":"2025-06-01T10:00:16+0000","dateFinished":"2025-06-01T10:00:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208445"},{"text":"%sh\nhadoop fs -mkdir /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-06-01T10:00:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"mkdir: `/tmp/ml-100k': File exists\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1748765668646_1513386354","id":"20250601-081428_1652930466","dateCreated":"2025-06-01T08:14:28+0000","dateStarted":"2025-06-01T08:15:35+0000","dateFinished":"2025-06-01T08:15:38+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:208446"},{"text":"%md\n## Put the file from local to the HDFS","user":"anonymous","dateUpdated":"2025-06-01T10:00:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Put the file from local to the HDFS</h2>\n"}]},"apps":[],"jobName":"paragraph_1748772023147_2071743422","id":"20250601-100023_1989309082","dateCreated":"2025-06-01T10:00:23+0000","dateStarted":"2025-06-01T10:00:34+0000","dateFinished":"2025-06-01T10:00:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208447"},{"text":"%sh\nhadoop fs -put /tmp/u.user /tmp/ml-100k/\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-06-01T10:00:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1748764232809_-232477152","id":"20250601-075032_970300856","dateCreated":"2025-06-01T07:50:32+0000","dateStarted":"2025-06-01T08:15:41+0000","dateFinished":"2025-06-01T08:15:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208448"},{"text":"%md\n## Create RDD for Spark analysis","user":"anonymous","dateUpdated":"2025-06-01T10:03:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Create RDD for Spark analysis</h2>\n"}]},"apps":[],"jobName":"paragraph_1748772040547_-327920144","id":"20250601-100040_999974092","dateCreated":"2025-06-01T10:00:40+0000","dateStarted":"2025-06-01T10:03:49+0000","dateFinished":"2025-06-01T10:03:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208449"},{"text":"%md\n### Create Users RDD and DataFrame","user":"anonymous","dateUpdated":"2025-06-01T10:04:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create Users RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1748772214090_-565084165","id":"20250601-100334_255312679","dateCreated":"2025-06-01T10:03:34+0000","dateStarted":"2025-06-01T10:04:09+0000","dateFinished":"2025-06-01T10:04:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208450"},{"text":"// Create a RDD of Users object\nfinal case class Users(userID: Int, age: Int, gender: String, occupation: String, zipcode: String)\n\n// read line by line from the `u.user` file in the HDFS and map it to the respective fields\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.user\").map(x => {val fields = x.split('|'); Users(fields(0).toInt, fields(1).toInt, fields(2), fields(3), fields(4))})\n\nimport sqlContext.implicits._\n\n// Convert to a DataFrame\nval usersDF = lines.toDF()\n\n// Show the DataFrame\nusersDF.show()","user":"anonymous","dateUpdated":"2025-06-01T10:03:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Users\nlines: org.apache.spark.rdd.RDD[Users] = MapPartitionsRDD[2] at map at <console>:56\nimport sqlContext.implicits._\nusersDF: org.apache.spark.sql.DataFrame = [userID: int, age: int ... 3 more fields]\n+------+---+------+-------------+-------+\n|userID|age|gender|   occupation|zipcode|\n+------+---+------+-------------+-------+\n|     1| 24|     M|   technician|  85711|\n|     2| 53|     F|        other|  94043|\n|     3| 23|     M|       writer|  32067|\n|     4| 24|     M|   technician|  43537|\n|     5| 33|     F|        other|  15213|\n|     6| 42|     M|    executive|  98101|\n|     7| 57|     M|administrator|  91344|\n|     8| 36|     M|administrator|  05201|\n|     9| 29|     M|      student|  01002|\n|    10| 53|     M|       lawyer|  90703|\n|    11| 39|     F|        other|  30329|\n|    12| 28|     F|        other|  06405|\n|    13| 47|     M|     educator|  29206|\n|    14| 45|     M|    scientist|  55106|\n|    15| 49|     F|     educator|  97301|\n|    16| 21|     M|entertainment|  10309|\n|    17| 30|     M|   programmer|  06355|\n|    18| 35|     F|        other|  37212|\n|    19| 40|     M|    librarian|  02138|\n|    20| 42|     F|    homemaker|  95660|\n+------+---+------+-------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748764301396_1202929049","id":"20250601-075141_186696073","dateCreated":"2025-06-01T07:51:41+0000","dateStarted":"2025-06-01T08:58:39+0000","dateFinished":"2025-06-01T08:59:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208451"},{"text":"%md\n### Create Ratings RDD and DataFrame","user":"anonymous","dateUpdated":"2025-06-01T10:04:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create Ratings RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1748772232411_-1829353727","id":"20250601-100352_1386531563","dateCreated":"2025-06-01T10:03:52+0000","dateStarted":"2025-06-01T10:04:03+0000","dateFinished":"2025-06-01T10:04:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208452"},{"text":"final case class Rating(userID: Int, movieID: Int, rating : Int)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x => {val fields = x.split(\"\\t\"); Rating(fields(0).toInt, fields(1).toInt, fields(2).toInt)})\n\nimport sqlContext.implicits._\n\nval ratingsDF = lines.toDF()\n\nratingsDF.show()","user":"anonymous","dateUpdated":"2025-06-01T08:59:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[9] at map at <console>:61\nimport sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [userID: int, movieID: int ... 1 more field]\n+------+-------+------+\n|userID|movieID|rating|\n+------+-------+------+\n|     0|     50|     5|\n|     0|    172|     5|\n|     0|    133|     1|\n|   196|    242|     3|\n|   186|    302|     3|\n|    22|    377|     1|\n|   244|     51|     2|\n|   166|    346|     1|\n|   298|    474|     4|\n|   115|    265|     2|\n|   253|    465|     5|\n|   305|    451|     3|\n|     6|     86|     3|\n|    62|    257|     2|\n|   286|   1014|     5|\n|   200|    222|     5|\n|   210|     40|     3|\n|   224|     29|     3|\n|   303|    785|     3|\n|   122|    387|     5|\n+------+-------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748764791044_975634918","id":"20250601-075951_343576443","dateCreated":"2025-06-01T07:59:51+0000","dateStarted":"2025-06-01T08:59:54+0000","dateFinished":"2025-06-01T08:59:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208453"},{"text":"%md\n### Create Movie RDD and DataFrame","user":"anonymous","dateUpdated":"2025-06-01T10:04:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create Movie RDD and DataFrame</h3>\n"}]},"apps":[],"jobName":"paragraph_1748772254594_1129411288","id":"20250601-100414_1092910371","dateCreated":"2025-06-01T10:04:14+0000","dateStarted":"2025-06-01T10:04:27+0000","dateFinished":"2025-06-01T10:04:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208454"},{"text":"final case class Movie(\n  movieID: Int,\n  title: String,\n  unknown: Int,\n  action: Int,\n  adventure: Int,\n  animation: Int,\n  children: Int,\n  comedy: Int,\n  crime: Int,\n  documentary: Int,\n  drama: Int,\n  fantasy: Int,\n  filmNoir: Int,\n  horror: Int,\n  musical: Int,\n  mystery: Int,\n  romance: Int,\n  sciFi: Int,\n  thriller: Int,\n  war: Int,\n  western: Int\n)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {\n  val fields = x.split('|')\n  Movie(\n    fields(0).toInt,\n    fields(1),\n    fields(5).toInt,\n    fields(6).toInt,\n    fields(7).toInt,\n    fields(8).toInt,\n    fields(9).toInt,\n    fields(10).toInt,\n    fields(11).toInt,\n    fields(12).toInt,\n    fields(13).toInt,\n    fields(14).toInt,\n    fields(15).toInt,\n    fields(16).toInt,\n    fields(17).toInt,\n    fields(18).toInt,\n    fields(19).toInt,\n    fields(20).toInt,\n    fields(21).toInt,\n    fields(22).toInt,\n    fields(23).toInt\n  )\n})\n\nimport sqlContext.implicits._\nval moviesDF = lines.toDF()\n\nmoviesDF.show()","user":"anonymous","dateUpdated":"2025-06-01T09:00:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[16] at map at <console>:64\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string ... 19 more fields]\n+-------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|movieID|               title|unknown|action|adventure|animation|children|comedy|crime|documentary|drama|fantasy|filmNoir|horror|musical|mystery|romance|sciFi|thriller|war|western|\n+-------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|      1|    Toy Story (1995)|      0|     0|        0|        1|       1|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      2|    GoldenEye (1995)|      0|     1|        1|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|      3|   Four Rooms (1995)|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|      4|   Get Shorty (1995)|      0|     1|        0|        0|       0|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      5|      Copycat (1995)|      0|     0|        0|        0|       0|     0|    1|          0|    1|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|      6|Shanghai Triad (Y...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      7|Twelve Monkeys (1...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    1|       0|  0|      0|\n|      8|         Babe (1995)|      0|     0|        0|        0|       1|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      9|Dead Man Walking ...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|     10|  Richard III (1995)|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  1|      0|\n|     11|Seven (Se7en) (1995)|      0|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|     12|Usual Suspects, T...|      0|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|     13|Mighty Aphrodite ...|      0|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|     14|  Postino, Il (1994)|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|\n|     15|Mr. Holland's Opu...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|     16|French Twist (Gaz...|      0|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|\n|     17|From Dusk Till Da...|      0|     1|        0|        0|       0|     1|    1|          0|    0|      0|       0|     1|      0|      0|      0|    0|       1|  0|      0|\n|     18|White Balloon, Th...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|     19|Antonia's Line (1...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|     20|Angels and Insect...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|\n+-------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748764903660_2107166109","id":"20250601-080143_442481103","dateCreated":"2025-06-01T08:01:43+0000","dateStarted":"2025-06-01T09:00:21+0000","dateFinished":"2025-06-01T09:00:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208455"},{"text":"%md\n### Create Temp Tables for SQL query","user":"anonymous","dateUpdated":"2025-06-01T10:04:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create Temp Tables for SQL query</h3>\n"}]},"apps":[],"jobName":"paragraph_1748772272713_-1377781111","id":"20250601-100432_2119740584","dateCreated":"2025-06-01T10:04:32+0000","dateStarted":"2025-06-01T10:04:47+0000","dateFinished":"2025-06-01T10:04:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208456"},{"text":"moviesDF.registerTempTable(\"titles\")\nratingsDF.registerTempTable(\"ratings\")\nusersDF.registerTempTable(\"users\")","user":"anonymous","dateUpdated":"2025-06-01T09:00:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nwarning: there was one deprecation warning; re-run with -deprecation for details\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1748766936554_-1349153686","id":"20250601-083536_723060756","dateCreated":"2025-06-01T08:35:36+0000","dateStarted":"2025-06-01T09:00:28+0000","dateFinished":"2025-06-01T09:00:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208457"},{"text":"%md\n## 1) Calculate the average rating for each movie.","user":"anonymous","dateUpdated":"2025-06-01T10:04:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>1) Calculate the average rating for each movie.</h2>\n"}]},"apps":[],"jobName":"paragraph_1748764015226_-361088909","id":"20250601-074655_1233757886","dateCreated":"2025-06-01T07:46:55+0000","dateStarted":"2025-06-01T10:04:54+0000","dateFinished":"2025-06-01T10:04:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208458"},{"text":"%sql\nSELECT \n    t.title,\n    AVG(r.rating) as avg_rating\nFROM ratings r\nJOIN titles t\nON r.movieID = t.movieID\nGROUP BY t.title\nORDER BY avg_rating DESC\nLIMIT 20","user":"anonymous","dateUpdated":"2025-06-01T10:04:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":true},"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tavg_rating\nThey Made Me a Criminal (1939)\t5.0\nGreat Day in Harlem, A (1994)\t5.0\nSaint of Fort Washington, The (1993)\t5.0\nPrefontaine (1997)\t5.0\nSanta with Muscles (1996)\t5.0\nEntertaining Angels: The Dorothy Day Story (1996)\t5.0\nStar Kid (1997)\t5.0\nSomeone Else's America (1995)\t5.0\nAiqing wansui (1994)\t5.0\nMarlene Dietrich: Shadow and Light (1996) \t5.0\nPather Panchali (1955)\t4.625\nSome Mother's Son (1996)\t4.5\nAnna (1996)\t4.5\nMaya Lin: A Strong Clear Vision (1994)\t4.5\nEverest (1998)\t4.5\nClose Shave, A (1995)\t4.491071428571429\nSchindler's List (1993)\t4.466442953020135\nWrong Trousers, The (1993)\t4.466101694915254\nCasablanca (1942)\t4.45679012345679\nWallace & Gromit: The Best of Aardman Animation (1996)\t4.447761194029851\n"}]},"apps":[],"jobName":"paragraph_1748764731171_496345058","id":"20250601-075851_486488278","dateCreated":"2025-06-01T07:58:51+0000","dateStarted":"2025-06-01T09:00:34+0000","dateFinished":"2025-06-01T09:00:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208459"},{"text":"%md\n## 2) Identify the top ten movies with the highest average ratings.","user":"anonymous","dateUpdated":"2025-06-01T08:40:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>2) Identify the top ten movies with the highest average ratings.</h2>\n"}]},"apps":[],"jobName":"paragraph_1748764034159_499255604","id":"20250601-074714_2026213695","dateCreated":"2025-06-01T07:47:14+0000","dateStarted":"2025-06-01T08:40:10+0000","dateFinished":"2025-06-01T08:40:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208460"},{"text":"%sql\nSELECT \n    t.title,\n    AVG(r.rating) as avg_rating\nFROM ratings r\nJOIN titles t\nON r.movieID = t.movieID\nGROUP BY t.title\nORDER BY avg_rating DESC\nLIMIT 10\n","user":"anonymous","dateUpdated":"2025-06-01T09:59:15+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tavg_rating\nSanta with Muscles (1996)\t5.0\nThey Made Me a Criminal (1939)\t5.0\nSaint of Fort Washington, The (1993)\t5.0\nGreat Day in Harlem, A (1994)\t5.0\nEntertaining Angels: The Dorothy Day Story (1996)\t5.0\nSomeone Else's America (1995)\t5.0\nAiqing wansui (1994)\t5.0\nStar Kid (1997)\t5.0\nMarlene Dietrich: Shadow and Light (1996) \t5.0\nPrefontaine (1997)\t5.0\n"}]},"apps":[],"jobName":"paragraph_1748767216414_-1270850445","id":"20250601-084016_851685417","dateCreated":"2025-06-01T08:40:16+0000","dateStarted":"2025-06-01T08:40:52+0000","dateFinished":"2025-06-01T08:40:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208461"},{"text":"%md\n## 3) Find the users who have rated at least 50 movies and identify their favourite movie genres.","user":"anonymous","dateUpdated":"2025-06-01T08:58:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>3) Find the users who have rated at least 50 movies and identify their favourite movie genres.</h2>\n"}]},"apps":[],"jobName":"paragraph_1748764070294_1831118379","id":"20250601-074750_515576247","dateCreated":"2025-06-01T07:47:50+0000","dateStarted":"2025-06-01T08:58:34+0000","dateFinished":"2025-06-01T08:58:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208462"},{"text":"%sql\n-- Filter users who rated at least 50 movies\nWITH filtered_users AS (\n  SELECT userID\n  FROM ratings\n  GROUP BY userID\n  HAVING COUNT(*) >= 50\n),\n\n-- Join ratings with filtered users and movies\nfiltered_ratings AS (\n  SELECT r.userID, r.movieID, r.rating, t.*\n  FROM ratings r\n  JOIN filtered_users u ON r.userID = u.userID\n  JOIN titles t ON r.movieID = t.movieID\n),\n\n-- Unpivot genre columns using UNION ALL\nuser_genres AS (\n  SELECT userID, 'unknown' AS genre FROM filtered_ratings WHERE unknown = 1 UNION ALL\n  SELECT userID, 'action' FROM filtered_ratings WHERE action = 1 UNION ALL\n  SELECT userID, 'adventure' FROM filtered_ratings WHERE adventure = 1 UNION ALL\n  SELECT userID, 'animation' FROM filtered_ratings WHERE animation = 1 UNION ALL\n  SELECT userID, 'children' FROM filtered_ratings WHERE children = 1 UNION ALL\n  SELECT userID, 'comedy' FROM filtered_ratings WHERE comedy = 1 UNION ALL\n  SELECT userID, 'crime' FROM filtered_ratings WHERE crime = 1 UNION ALL\n  SELECT userID, 'documentary' FROM filtered_ratings WHERE documentary = 1 UNION ALL\n  SELECT userID, 'drama' FROM filtered_ratings WHERE drama = 1 UNION ALL\n  SELECT userID, 'fantasy' FROM filtered_ratings WHERE fantasy = 1 UNION ALL\n  SELECT userID, 'filmNoir' FROM filtered_ratings WHERE filmNoir = 1 UNION ALL\n  SELECT userID, 'horror' FROM filtered_ratings WHERE horror = 1 UNION ALL\n  SELECT userID, 'musical' FROM filtered_ratings WHERE musical = 1 UNION ALL\n  SELECT userID, 'mystery' FROM filtered_ratings WHERE mystery = 1 UNION ALL\n  SELECT userID, 'romance' FROM filtered_ratings WHERE romance = 1 UNION ALL\n  SELECT userID, 'sciFi' FROM filtered_ratings WHERE sciFi = 1 UNION ALL\n  SELECT userID, 'thriller' FROM filtered_ratings WHERE thriller = 1 UNION ALL\n  SELECT userID, 'war' FROM filtered_ratings WHERE war = 1 UNION ALL\n  SELECT userID, 'western' FROM filtered_ratings WHERE western = 1\n),\n\n-- Count genre frequencies per user\nuser_genre_counts AS (\n  SELECT userID, genre, COUNT(*) AS count\n  FROM user_genres\n  GROUP BY userID, genre\n),\n\n-- Rank genres per user\nranked_genres AS (\n  SELECT *,\n         ROW_NUMBER() OVER (PARTITION BY userID ORDER BY count DESC) AS rank\n  FROM user_genre_counts\n)\n\n-- Select top genre per user\nSELECT userID, genre, count\nFROM ranked_genres\nWHERE rank = 1\nORDER BY count DESC\n","user":"anonymous","dateUpdated":"2025-06-01T23:44:53+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"genre","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"genre","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"userID\tgenre\tcount\n655\tdrama\t410\n405\tdrama\t309\n537\tdrama\t251\n450\tdrama\t237\n13\tdrama\t218\n234\tdrama\t213\n416\tdrama\t212\n279\tcomedy\t211\n201\tdrama\t196\n393\tcomedy\t191\n181\tdrama\t188\n303\tcomedy\t184\n334\tdrama\t174\n90\tdrama\t173\n378\tdrama\t170\n276\tdrama\t168\n429\tdrama\t167\n474\tdrama\t166\n293\tdrama\t165\n308\tdrama\t163\n592\tdrama\t162\n59\tdrama\t162\n846\tdrama\t161\n94\tdrama\t155\n561\tdrama\t155\n880\tcomedy\t154\n85\tdrama\t152\n406\tdrama\t151\n269\tdrama\t148\n7\tdrama\t146\n894\tdrama\t146\n707\tdrama\t145\n642\tcomedy\t141\n184\tdrama\t141\n18\tdrama\t141\n896\tdrama\t138\n151\tdrama\t137\n682\tdrama\t137\n354\tdrama\t136\n328\tdrama\t135\n271\tdrama\t134\n916\tdrama\t134\n92\tdrama\t133\n727\taction\t132\n747\tdrama\t132\n222\tcomedy\t131\n286\tcomedy\t131\n524\tdrama\t130\n796\tdrama\t129\n435\tcomedy\t128\n551\tdrama\t128\n535\tdrama\t127\n417\tcomedy\t127\n194\tdrama\t126\n299\tdrama\t126\n311\tdrama\t126\n889\tdrama\t125\n345\tdrama\t125\n883\tdrama\t124\n870\tdrama\t124\n758\tdrama\t123\n385\tdrama\t123\n130\taction\t120\n389\tcomedy\t120\n343\tdrama\t119\n268\tcomedy\t118\n125\tcomedy\t118\n437\tdrama\t117\n457\tdrama\t116\n387\tdrama\t116\n144\tdrama\t116\n648\tcomedy\t114\n305\tdrama\t114\n87\tcomedy\t113\n327\tdrama\t113\n533\tdrama\t112\n314\tcomedy\t111\n425\taction\t111\n339\tdrama\t110\n798\tcomedy\t110\n454\tdrama\t110\n864\tdrama\t109\n500\tdrama\t108\n919\tdrama\t108\n62\tdrama\t108\n711\tdrama\t108\n618\tdrama\t108\n363\tdrama\t108\n497\tcomedy\t107\n1\tdrama\t107\n804\tcomedy\t105\n749\taction\t105\n854\tdrama\t105\n788\tdrama\t105\n504\tdrama\t104\n224\tdrama\t104\n6\tdrama\t104\n666\tdrama\t103\n653\tdrama\t103\n790\tcomedy\t103\n608\tdrama\t103\n399\tdrama\t103\n650\tdrama\t102\n145\tdrama\t102\n342\tdrama\t102\n244\tcomedy\t101\n409\tdrama\t101\n102\taction\t101\n472\taction\t101\n716\tdrama\t101\n207\tdrama\t100\n336\tcomedy\t100\n178\tdrama\t99\n455\tdrama\t99\n301\tcomedy\t98\n458\tdrama\t98\n95\tdrama\t97\n374\tdrama\t97\n833\tdrama\t97\n627\tdrama\t96\n312\tdrama\t96\n189\tdrama\t96\n456\tdrama\t95\n588\tdrama\t95\n532\tdrama\t95\n805\tcomedy\t95\n639\tdrama\t94\n291\tcomedy\t93\n757\taction\t92\n782\tdrama\t92\n486\tdrama\t92\n932\tdrama\t92\n886\tdrama\t91\n660\taction\t91\n407\tcomedy\t91\n373\tdrama\t90\n174\tcomedy\t90\n49\tcomedy\t88\n452\tdrama\t88\n807\taction\t88\n109\taction\t87\n280\tdrama\t87\n43\tcomedy\t87\n659\tdrama\t86\n503\tdrama\t86\n60\tdrama\t85\n128\tdrama\t85\n840\tdrama\t85\n313\tdrama\t85\n721\tdrama\t85\n487\taction\t84\n318\tcomedy\t84\n514\tdrama\t83\n881\tcomedy\t83\n543\tdrama\t83\n606\tdrama\t83\n774\taction\t83\n344\tdrama\t83\n586\taction\t83\n5\tcomedy\t82\n11\tdrama\t82\n119\tdrama\t82\n56\tcomedy\t81\n693\tdrama\t81\n10\tdrama\t81\n545\taction\t81\n346\taction\t81\n158\taction\t81\n468\tdrama\t81\n296\tdrama\t80\n664\tdrama\t79\n200\taction\t79\n527\tdrama\t78\n380\tdrama\t78\n826\taction\t78\n64\tdrama\t78\n506\tcomedy\t78\n622\taction\t77\n712\tcomedy\t77\n671\taction\t77\n332\tthriller\t77\n239\tdrama\t76\n795\tcomedy\t76\n197\taction\t76\n878\tdrama\t76\n347\taction\t75\n600\taction\t75\n479\taction\t75\n320\taction\t75\n643\tcomedy\t74\n267\taction\t74\n321\tdrama\t74\n621\tcomedy\t74\n83\tcomedy\t74\n295\tdrama\t73\n868\tcomedy\t73\n394\taction\t73\n593\tdrama\t73\n256\taction\t73\n398\tcomedy\t73\n22\tcomedy\t72\n567\tdrama\t72\n116\tdrama\t72\n198\tdrama\t72\n663\tdrama\t72\n709\taction\t72\n828\tdrama\t72\n619\taction\t72\n379\tdrama\t72\n495\taction\t71\n933\taction\t71\n542\tcomedy\t71\n488\tdrama\t71\n733\tdrama\t71\n498\tdrama\t70\n907\tdrama\t70\n763\tdrama\t70\n815\tdrama\t70\n246\taction\t69\n892\tdrama\t69\n217\taction\t69\n476\tcomedy\t69\n214\tdrama\t69\n851\tdrama\t69\n585\tdrama\t68\n694\tdrama\t68\n936\tdrama\t68\n751\tcomedy\t68\n484\taction\t68\n934\tdrama\t68\n521\taction\t68\n823\tdrama\t68\n766\tdrama\t68\n58\tdrama\t67\n72\tdrama\t67\n548\tthriller\t67\n903\tdrama\t67\n297\tdrama\t67\n615\tdrama\t66\n42\tdrama\t66\n629\tdrama\t66\n391\tdrama\t66\n566\tdrama\t66\n738\taction\t66\n21\tthriller\t66\n690\tcomedy\t66\n436\tdrama\t65\n715\taction\t65\n262\tdrama\t64\n943\taction\t64\n577\tcomedy\t64\n401\tdrama\t64\n624\tdrama\t63\n264\tcomedy\t63\n381\tdrama\t63\n634\tdrama\t63\n233\tdrama\t63\n843\tdrama\t63\n536\tdrama\t62\n442\taction\t62\n325\tdrama\t62\n236\tdrama\t62\n835\tdrama\t61\n887\tcomedy\t61\n249\tdrama\t61\n862\tdrama\t61\n773\tdrama\t61\n326\tdrama\t61\n210\tcomedy\t59\n601\tdrama\t59\n645\tdrama\t59\n463\tdrama\t59\n705\taction\t59\n453\tdrama\t59\n243\tdrama\t59\n82\tdrama\t58\n848\tdrama\t58\n360\tdrama\t58\n232\tdrama\t58\n466\taction\t58\n294\taction\t58\n897\taction\t57\n523\tcomedy\t57\n927\tcomedy\t57\n392\tdrama\t57\n216\tdrama\t57\n847\tcomedy\t57\n104\tdrama\t57\n901\tcomedy\t56\n213\tdrama\t56\n270\tdrama\t56\n16\tdrama\t56\n699\tdrama\t56\n263\tdrama\t55\n665\tdrama\t55\n493\taction\t55\n221\taction\t54\n152\tcomedy\t54\n806\tdrama\t54\n23\tdrama\t54\n918\tdrama\t54\n290\taction\t53\n654\tdrama\t53\n913\tdrama\t53\n445\tdrama\t53\n330\tdrama\t53\n361\tdrama\t53\n871\tdrama\t53\n99\tdrama\t53\n254\tchildren\t52\n496\tdrama\t52\n177\tdrama\t52\n316\tdrama\t52\n541\tcomedy\t52\n160\tdrama\t51\n186\tthriller\t51\n44\tdrama\t51\n298\tdrama\t51\n875\tdrama\t50\n230\tdrama\t50\n825\tdrama\t50\n684\tcomedy\t50\n37\taction\t50\n110\taction\t50\n637\tdrama\t49\n661\tdrama\t49\n786\tdrama\t49\n669\tdrama\t49\n638\taction\t49\n746\taction\t49\n605\tdrama\t49\n554\tdrama\t48\n940\tdrama\t48\n478\tcomedy\t48\n292\tdrama\t48\n288\tdrama\t48\n553\tdrama\t48\n447\tdrama\t48\n235\tdrama\t48\n591\tcomedy\t48\n70\taction\t48\n899\taction\t48\n15\tdrama\t48\n748\tdrama\t47\n704\tdrama\t47\n922\tcomedy\t47\n122\tdrama\t47\n397\tdrama\t47\n499\tdrama\t47\n632\tdrama\t47\n57\tcomedy\t46\n76\tdrama\t46\n863\tdrama\t46\n65\tdrama\t46\n383\tdrama\t46\n698\tdrama\t46\n617\thorror\t46\n91\tdrama\t46\n885\tcomedy\t46\n323\tdrama\t46\n882\tcomedy\t45\n223\tcomedy\t45\n867\tdrama\t45\n640\tcomedy\t45\n764\tdrama\t45\n830\taction\t45\n505\tdrama\t45\n620\tchildren\t44\n188\tdrama\t44\n423\tdrama\t44\n460\tdrama\t44\n159\tcomedy\t43\n38\tcomedy\t43\n121\tdrama\t43\n579\tcomedy\t43\n193\tcomedy\t42\n890\tdrama\t42\n255\tthriller\t42\n877\tdrama\t42\n63\tdrama\t42\n731\tdrama\t42\n921\tcomedy\t42\n683\tdrama\t42\n275\taction\t42\n250\tdrama\t42\n459\taction\t42\n26\tdrama\t41\n708\tcomedy\t41\n538\tdrama\t41\n568\tdrama\t41\n924\tdrama\t41\n115\tdrama\t41\n449\tdrama\t41\n717\tdrama\t40\n710\tdrama\t40\n630\tdrama\t40\n106\tdrama\t40\n829\tdrama\t40\n331\tdrama\t40\n257\tdrama\t40\n195\tdrama\t40\n595\tdrama\t40\n215\tdrama\t40\n938\tcomedy\t40\n741\tcomedy\t40\n8\taction\t39\n560\tdrama\t39\n492\tdrama\t39\n14\tdrama\t39\n89\tdrama\t39\n625\tcomedy\t39\n719\tdrama\t38\n489\tdrama\t38\n451\tdrama\t38\n307\taction\t38\n79\tdrama\t38\n860\tdrama\t38\n697\tthriller\t38\n141\tcomedy\t37\n426\tdrama\t37\n756\taction\t37\n465\tdrama\t37\n658\tdrama\t37\n539\tdrama\t37\n587\tdrama\t37\n24\tdrama\t37\n283\tcomedy\t36\n686\tdrama\t36\n176\tdrama\t36\n752\tdrama\t36\n253\tdrama\t36\n931\tdrama\t35\n911\tcomedy\t35\n2\tdrama\t35\n745\tdrama\t35\n422\tdrama\t35\n518\tdrama\t35\n75\tcomedy\t35\n610\tdrama\t35\n315\tdrama\t35\n724\tdrama\t34\n838\tdrama\t34\n831\tdrama\t34\n802\thorror\t34\n552\tcomedy\t33\n164\tthriller\t33\n470\tdrama\t33\n372\tthriller\t33\n382\tdrama\t33\n123\tdrama\t33\n559\tdrama\t33\n508\tcomedy\t33\n844\taction\t32\n338\tcomedy\t32\n206\tdrama\t32\n396\tthriller\t32\n430\tdrama\t32\n117\taction\t32\n834\tdrama\t32\n526\tdrama\t32\n28\tthriller\t31\n161\tdrama\t31\n367\thorror\t31\n776\thorror\t31\n73\tdrama\t31\n324\tdrama\t31\n187\tdrama\t31\n77\tdrama\t31\n761\tdrama\t31\n942\tdrama\t31\n251\taction\t31\n100\tdrama\t31\n735\tdrama\t30\n52\tdrama\t30\n54\tthriller\t30\n569\tdrama\t30\n48\tdrama\t30\n507\taction\t30\n329\tdrama\t30\n534\tthriller\t29\n633\taction\t29\n183\taction\t29\n227\tdrama\t29\n501\tdrama\t29\n413\tdrama\t29\n365\tdrama\t29\n277\tdrama\t29\n402\tdrama\t29\n908\tdrama\t29\n753\tdrama\t29\n370\tdrama\t28\n135\tthriller\t28\n440\tdrama\t28\n821\tdrama\t28\n69\tdrama\t28\n771\tcomedy\t28\n113\tdrama\t28\n480\tdrama\t28\n768\tdrama\t28\n118\tdrama\t28\n540\tdrama\t28\n180\tdrama\t28\n734\tdrama\t28\n226\tdrama\t28\n573\tdrama\t28\n557\tdrama\t28\n274\tdrama\t27\n190\tthriller\t27\n872\tcomedy\t27\n910\taction\t27\n357\tcomedy\t27\n770\tdrama\t27\n562\tdrama\t27\n676\tcomedy\t27\n647\taction\t27\n411\taction\t27\n839\tdrama\t26\n84\tdrama\t26\n923\tthriller\t26\n481\tcomedy\t26\n167\tdrama\t26\n25\tcomedy\t26\n787\tdrama\t26\n218\tcomedy\t26\n836\tdrama\t26\n780\tdrama\t26\n101\tcomedy\t25\n930\tcomedy\t25\n168\tcomedy\t25\n148\tdrama\t25\n490\tdrama\t25\n154\tdrama\t25\n778\tdrama\t25\n138\tdrama\t25\n322\tdrama\t24\n893\taction\t24\n464\tthriller\t24\n81\tcomedy\t24\n41\tdrama\t24\n421\tthriller\t24\n248\taction\t24\n12\tdrama\t24\n679\tcomedy\t24\n432\tcomedy\t24\n483\taction\t24\n287\tcomedy\t23\n348\tcomedy\t23\n395\tdrama\t23\n388\tthriller\t22\n912\tdrama\t22\n525\tdrama\t22\n3\tdrama\t22\n97\tdrama\t22\n428\tdrama\t22\n412\tdrama\t22\n272\tdrama\t22\n546\taction\t22\n865\tcomedy\t21\n582\taction\t21\n793\tdrama\t21\n157\tdrama\t21\n850\tcomedy\t20\n371\taction\t20\n555\tcomedy\t20\n350\tdrama\t19\n403\tcomedy\t18\n96\tdrama\t17\n528\tcomedy\t17\n"}]},"apps":[],"jobName":"paragraph_1748792373559_1511366033","id":"20250601-153933_1772289805","dateCreated":"2025-06-01T15:39:33+0000","dateStarted":"2025-06-01T15:43:51+0000","dateFinished":"2025-06-01T15:50:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208463"},{"text":"%md\n## 4) Find all the users who are less than 20 years old.","user":"anonymous","dateUpdated":"2025-06-01T09:57:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>4) Find all the users who are less than 20 years old.</h2>\n"}]},"apps":[],"jobName":"paragraph_1748764085630_-1448850671","id":"20250601-074805_626279176","dateCreated":"2025-06-01T07:48:05+0000","dateStarted":"2025-06-01T07:48:31+0000","dateFinished":"2025-06-01T07:48:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208464"},{"text":"val young = usersDF.filter($\"age\" < 20)\n\nyoung.show()\n","user":"anonymous","dateUpdated":"2025-06-01T10:05:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"young: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, age: int ... 3 more fields]\n+------+---+------+-------------+-------+\n|userID|age|gender|   occupation|zipcode|\n+------+---+------+-------------+-------+\n|    30|  7|     M|      student|  55436|\n|    36| 19|     F|      student|  93117|\n|    52| 18|     F|      student|  55105|\n|    57| 16|     M|         none|  84010|\n|    67| 17|     M|      student|  60402|\n|    68| 19|     M|      student|  22904|\n|   101| 15|     M|      student|  05146|\n|   110| 19|     M|      student|  77840|\n|   142| 13|     M|        other|  48118|\n|   179| 15|     M|entertainment|  20755|\n|   206| 14|     F|      student|  53115|\n|   221| 19|     M|      student|  20685|\n|   223| 19|     F|      student|  47906|\n|   246| 19|     M|      student|  28734|\n|   257| 17|     M|      student|  77005|\n|   258| 19|     F|      student|  77801|\n|   262| 19|     F|      student|  78264|\n|   270| 18|     F|      student|  63119|\n|   281| 15|     F|      student|  06059|\n|   289| 11|     M|         none|  94619|\n+------+---+------+-------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1748771566327_-2031710867","id":"20250601-095246_369636275","dateCreated":"2025-06-01T09:52:46+0000","dateStarted":"2025-06-01T09:54:49+0000","dateFinished":"2025-06-01T09:54:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208465"},{"text":"%md\n## 5) Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.","user":"anonymous","dateUpdated":"2025-06-01T23:44:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>5) Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.</h2>\n"}]},"apps":[],"jobName":"paragraph_1748764099759_18227534","id":"20250601-074819_1245780377","dateCreated":"2025-06-01T07:48:19+0000","dateStarted":"2025-06-01T07:48:54+0000","dateFinished":"2025-06-01T07:48:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208466"},{"text":"val scientist3040 = usersDF\n    .filter($\"age\" > 30 && $\"age\" < 40 && $\"occupation\" === \"scientist\")\n    \nscientist3040.show()","user":"anonymous","dateUpdated":"2025-06-01T15:38:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"scientist3040: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, age: int ... 3 more fields]\n+------+---+------+----------+-------+\n|userID|age|gender|occupation|zipcode|\n+------+---+------+----------+-------+\n|    40| 38|     M| scientist|  27514|\n|    71| 39|     M| scientist|  98034|\n|    74| 39|     M| scientist|  T8H1N|\n|   107| 39|     M| scientist|  60466|\n|   183| 33|     M| scientist|  27708|\n|   272| 33|     M| scientist|  53706|\n|   337| 37|     M| scientist|  10522|\n|   430| 38|     M| scientist|  98199|\n|   538| 31|     M| scientist|  21010|\n|   543| 33|     M| scientist|  95123|\n|   554| 32|     M| scientist|  62901|\n|   643| 39|     M| scientist|  55122|\n|   730| 31|     F| scientist|  32114|\n|   874| 36|     M| scientist|  37076|\n+------+---+------+----------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1748764133750_402069019","id":"20250601-074853_95309685","dateCreated":"2025-06-01T07:48:53+0000","dateStarted":"2025-06-01T09:57:27+0000","dateFinished":"2025-06-01T09:57:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208467"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1748771805940_1841123945","id":"20250601-095645_1372081403","dateCreated":"2025-06-01T09:56:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:208468"}],"name":"SQTD6324_Project3_P153146","id":"2KYBA719A","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}